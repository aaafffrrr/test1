<!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Stripe Test</title>
        <script src="https://js.stripe.com/v3/"></script>
    </head>
    <body>
        <h1>Stripe Payment Integration</h1>
        <button id="checkout-button">Checkout</button>
        <button id="payment-intent-button">Pay with Payment Intent</button>
        <button id="subscription-button">Subscribe</button>

        <script>
            const stripe = Stripe('<%= publishableKey %>');

            // Stripe Checkout
            document.getElementById('checkout-button').addEventListener('click', async () => {
                const { id } = await fetch('/create-checkout-session', { method: 'POST' }).then(res => res.json());
                stripe.redirectToCheckout({ sessionId: id });
            });

            // Payment Intents
            document.getElementById('payment-intent-button').addEventListener('click', async () => {
                const { clientSecret } = await fetch('/create-payment-intent', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ amount: 2000 })
                }).then(res => res.json());

                const result = await stripe.confirmCardPayment(clientSecret, {
                    payment_method: {
                        card: stripe.elements().create('card'),
                        billing_details: {
                            name: 'Customer Name',
                        },
                    },
                });

                if (result.error) {
                    console.error(result.error.message);
                } else {
                    if (result.paymentIntent.status === 'succeeded') {
                        alert('Payment succeeded!');
                    }
                }
            });

            // Subscription
            document.getElementById('subscription-button').addEventListener('click', async () => {
                const { error, paymentMethod } = await stripe.createPaymentMethod({
                    type: 'card',
                    card: stripe.elements().create('card'),
                });

                if (error) {
                    console.error(error);
                } else {
                    const subscription = await fetch('/create-subscription', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            paymentMethodId: paymentMethod.id,
                            customerEmail: 'customer@example.com'
                        }),
                    }).then(res => res.json());

                    console.log(subscription);
                }
            });
        </script>
    </body>
    </html>